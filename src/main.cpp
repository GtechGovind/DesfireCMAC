#include <iostream>
#include "../include/cmac/CMAC.h"

int main() {

    CMAC cmac;

    vector<unsigned char> key = {0x22, 0x7E, 0xAC, 0x50, 0x8F, 0xB2, 0xD1, 0x30, 0xE0, 0x45, 0x19, 0x88, 0xD5, 0x1F, 0x8D, 0xD0};
    vector<unsigned char> iv = {0xB9, 0x87, 0x07, 0x4D, 0x3F, 0x60, 0xEE, 0xF6, 0xC1, 0x80, 0x34, 0x55, 0x1A, 0xA7, 0x9E, 0x09};
    vector<unsigned char> message = {0xBD, 0x02, 0x00, 0x00, 0x00, 0x0F, 0x00, 0x00};

    cmac.initCMAC(key, iv);
    //cmac.getCMAC(message);

    cout << "CMAC: ";
    for (auto &i : cmac.getCMAC(message)) {
        cout << hex << uppercase << (int) i << " ";
    }

}
